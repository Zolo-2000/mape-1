{% extends 'base.html' %}
{% load staticfiles %}

{% block css %}
    <link href="{% static 'showcase/css/map.css' %}" rel="stylesheet">    
    <link href="{% static 'plugins/clockpicker/clockpicker.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Parallax -->
<div class="parallax-container no-padding">
    <div class="parallax"><img src="{% static 'showcase/img/event-header.jpg' %}"></div>
</div>

<!-- Informacion extra -->
<div class="franja right-align">
    {% for category in object.categories.all %}
    {{ category.name }} &#8226;
    {% endfor %}
    <!-- si es publico o privado -->
    {% if object.is_public %}
    Publico &#8226;
    {% else %}
    Privado &#8226;
    {%endif%}
    <!-- si esta abierto -->
    Abierto &#8226;
    <!-- Si esta verificado-->
    <i class="tiny material-icons">done</i> Verificado
</div>

<!-- Seccion central -->
<div class="section white no-padding row">
    <div class="container">
        <div class="card">
            <!-- Cabecera de la localidad -->
            <div class="card-content row">
                <div class="col s12 m12 l6 ">
                    {% if  object.is_public %}                    
                    <div class="col s6 offset-l3 offset-s3">
                        <img class="responsive-img circle" width="200"src="{% static 'showcase/img/alcaldia_morona.png' %}">
                    </div>
                    {% endif %}
                    <h3 class="header">{{ object.name }}</h3>

                    <h4 class="grey-text"> #{{ object.name }} </h4>
                    
                    <div class="left-align">
                        {% if is_subscribed %}
                        <button class="btn amber darken-3" type="submit" class="waves-effect waves-light btn"><i class="material-icons right">grade</i>Suscrito</button>
                        {% else %}
                        <form action="/subscriber/add/" method="POST" enctype="multipart/form-data" novalidate>
                          {% csrf_token %}
                          <input type="hidden" name="profile" value="{{ user.profile.id }}">
                          <input type="hidden" name="contenttype" value="{{ contenttype.id }}">
                          <input type="hidden" name="object_id" value="{{ object.id }}">
                          <input type="hidden" name="next" value="/locality/{{ object.id }}/">
                          <button type="submit" class="waves-effect waves-light btn"><i class="material-icons">grade</i>Subscribirse</button>    
                        </form>
                        {% endif %}
                        <!-- Contador de suscriptores -->                        
                        <p class="flow-text"> {{ object.subscribers_count }} Suscriptores</p>

                        <a href="{% url 'locality_update' object.id %}" class="btn grey darken-3">Editar</a>

                    </div>                    
                </div>
                <!-- Imagenes -->
                <div class="carousel col s12 m12 l6">
                    <i class="material-icons right">code</i><span>Fotos en el sitio:</span>
                    {% for comment in object.comments %}
                    {% if comment.image %}
                    <a class="carousel-item" href="{{ comment.image.url }}">
                        <img src="{{ comment.image.url }}">
                    </a>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>

            <!-- Tabs de la tarjeta -->
            <div class="card-tabs">
                <ul class="tabs tabs-fixed-width">
                  <li class="tab"><a class="active" href="#description">Descripci贸n</a></li>
                  <!-- El "tab" Media debe ir activo al momento de cargar la pagina debido a un bug -->
                  <li class="tab"><a href="#media">Media</a></li>
                  <li class="tab"><a href="#events">Eventos</a></li>
                </ul>
            </div>
          <!-- Contenido de los tabs -->
          <div class="card-content row grey lighten-4">
            <!-- Informaci贸n-->
            <div id="description">
              <!-- Descripcion -->
              <div class="card-panel ">
                <span class="card-title">{{ object.name }}</span>
                <p align="justify"><span>{{ object.description }}</span></p>
              </div>
              <!-- Grupo de colacoracion en la localidad -->
              <div class="card-panel grey lighten-2">
                <span class="card-title grey-text">En colaboraci贸n con:</span>
                <div class="chip">
                    <img src="{% static 'showcase/img/event-header.jpg' %}" alt="Contact Person">
                    <a href="">Denis Siavichay</a>
                </div>
                <div class="chip">
                    <img src="{% static 'showcase/img/event-header.jpg' %}" alt="Contact Person">
                    <a href="">Pepe Lucho</a>
                </div>
                <div class="chip amber lighten-2">
                    <img src="{% static 'showcase/img/event-header.jpg' %}" alt="Contact Person">
                    <a href="">Alcaldia de Morona</a>
                </div>
              </div>
              <!-- Informacion de Contacto -->
              <div class="col s12 row">
                <div class="col s12 m4 l4"><h5>Direcci贸n:</h5>
                  <p> Don bosco y Riobamba </p></div>
                <div class="col s12 m4 l4"><h5>Pagina web:</h5>
                  <p> www.pagina.com </p>
                </div>
                <div clas="col s12 m4 l4">
                  <h5>Telefonos:</h5>
                  <p>123123423541234{{ user.cellphone }}</p></div>
              </div>
            </div>
            <!-- Media -->
            <div id="media" class="row">
                <div class="col s12 ">
                    {% for comment in object.comments %}
                    {% if comment.image %}
                    <div class="col s2">
                        <img class="materialboxed" style="width: 100%" src="{{ comment.image.url }}">
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
            <!-- Eventos de la Localidad -->
            <div id="events" class="row">
              <div class="section col s12 m12 l6 offset-l3">
                <!-- Tarjeta de evento -->
                {% include 'includes/event_card.html'%}
              </div>
            </div> 
          </div><!-- Fin tarjeta evento -->
          </div>
        </div>
        <!-- Comentarios -->
        <div class="section col s12 m8 l8 offset-m2 offset-l2">
            {% include 'includes/comments.html' with comments=object.comments model_name="locality" model_id=object.id %}        
        </div>
    </div>
    {% include 'includes/footer.html' %}
</div>
{% endblock %}

{% block js %}
    <script src="{% static 'plugins/clockpicker/clockpicker.js' %}"></script>
    <script src="{% static 'showcase/js/rango-jquery.js' %}"></script> 
{% endblock %}