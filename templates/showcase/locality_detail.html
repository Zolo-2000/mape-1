{% extends 'base.html' %}
{% load staticfiles %}

{% block css %}
    <link href="{% static 'showcase/css/map.css' %}" rel="stylesheet">    
    <link href="{% static 'plugins/clockpicker/clockpicker.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Parallax -->
<div class="parallax-container no-padding">
    <div class="parallax"><img src="{% static 'showcase/img/event-header.jpg' %}"></div>
</div>

<!-- Informacion extra -->
<div class="franja right-align">
    {% for category in object.categories.all %}
    {{ category.name }} &#8226;
    {% endfor %}
    <!-- si es publico o privado -->
    {% if object.is_public %}
    Publico &#8226;
    {% else %}
    Privado &#8226;
    {%endif%}
    <!-- si esta abierto -->
    Abierto &#8226;
    <!-- Si esta verificado-->
    <i class="tiny material-icons">done</i> Verificado
</div>

<!-- Seccion central -->
<div class="section white no-padding row">
    <div class="container">
        <div class="card">
            <!-- Cabecera de la localidad -->
            <div class="card-content row">
                <div class="col s12 m12 l6 ">
                    {% if  object.is_public %}                    
                    <div class="col s6 offset-l3 offset-s3">
                        <img class="responsive-img circle" width="200"src="{% static 'showcase/img/alcaldia_morona.png' %}">
                    </div>
                    {% endif %}
                    <h3 class="header">{{ object.name }}</h3>

                    <h4 class="grey-text"> #{{ object.name }} </h4>
                    
                    <div class="left-align">
                        {% if is_subscribed %}
                        <button class="btn amber darken-3" type="submit" class="waves-effect waves-light btn"><i class="material-icons right">grade</i>Suscrito</button>
                        {% else %}
                        <form action="/subscriber/add/" method="POST" enctype="multipart/form-data" novalidate>
                          {% csrf_token %}
                          <input type="hidden" name="profile" value="{{ user.profile.id }}">
                          <input type="hidden" name="contenttype" value="{{ contenttype.id }}">
                          <input type="hidden" name="object_id" value="{{ object.id }}">
                          <input type="hidden" name="next" value="/locality/{{ object.id }}/">
                          <button type="submit" class="waves-effect waves-light btn"><i class="material-icons">grade</i>Subscribirse</button>    
                        </form>
                        {% endif %}
                        <!-- Contador de suscriptores -->                        
                        <p class="flow-text"> {{ object.subscribers_count }} Suscriptores</p>

                        <a href="{% url 'locality_update' object.id %}" class="btn grey darken-3">Editar</a>

                    </div>                    
                </div>
                <!-- Imagenes -->
                <div class="carousel col s12 m12 l6">
                    <i class="material-icons right">code</i><span>Fotos en el sitio:</span>
                    {% for comment in object.comments %}
                    {% if comment.image %}
                    <a class="carousel-item" href="{{ comment.image.url }}">
                        <img src="{{ comment.image.url }}">
                    </a>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>

            <!-- Tabs de la tarjeta -->
            <div class="card-tabs">
                <ul class="tabs tabs-fixed-width">
                  <li class="tab"><a class="active" href="#description">Descripción</a></li>
                  <!-- El "tab" Media debe ir activo al momento de cargar la pagina debido a un bug -->
                  <li class="tab"><a href="#media">Media</a></li>
                  <li class="tab"><a href="#events">Eventos</a></li>
                </ul>
            </div>
          <!-- Contenido de los tabs -->
          <div class="card-content row grey lighten-4">
            <!-- Información-->
            <div id="description">
              <!-- Descripcion -->
              <div class="card-panel ">
                <span class="card-title">{{ object.name }}</span>
                <p align="justify"><span>{{ object.description }}</span></p>
              </div>
              <!-- Grupo de colacoracion en la localidad -->
              <div class="card-panel grey lighten-2">
                <span class="card-title grey-text">En colaboración con:</span>
                <div class="chip">
                    <img src="{% static 'showcase/img/event-header.jpg' %}" alt="Contact Person">
                    <a href="">Denis Siavichay</a>
                </div>
                <div class="chip">
                    <img src="{% static 'showcase/img/event-header.jpg' %}" alt="Contact Person">
                    <a href="">Pepe Lucho</a>
                </div>
                <div class="chip amber lighten-2">
                    <img src="{% static 'showcase/img/event-header.jpg' %}" alt="Contact Person">
                    <a href="">Alcaldia de Morona</a>
                </div>
              </div>
              <!-- Informacion de Contacto -->
              <div class="col s12 row">
                <div class="col s12 m4 l4"><h5>Dirección:</h5>
                  <p> Don bosco y Riobamba </p></div>
                <div class="col s12 m4 l4"><h5>Pagina web:</h5>
                  <p> www.pagina.com </p>
                </div>
                <div clas="col s12 m4 l4">
                  <h5>Telefonos:</h5>
                  <p>123123423541234{{ user.cellphone }}</p></div>
              </div>
            </div>
            <!-- Media -->
            <div id="media" class="row">
                <div class="col s12 ">
                    {% for comment in object.comments %}
                    {% if comment.image %}
                    <div class="col s2">
                        <img class="materialboxed" style="width: 100%" src="{{ comment.image.url }}">
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
            <!-- Eventos de la Localidad -->
            <div id="events" class="row">
              <div class="section col s12 m12 l6 offset-l3">
                <!-- Tarjeta de evento -->
                <div class="card">
                  <!-- Imagen de la tarjeta -->
                  <div class="card-image z-depth-3 waves-effect waves-block waves-light ">
                    {% if not objects.front_image %}
                    <img class="activator" src="{% static 'showcase/img/event-header.jpg' %}">{%else%}
                    <i class="activator material-icons large">perm_media</i>
                     {%endif%}
                  </div>
                  <!-- Cabecera de la tarjeta -->
                  <div class="card-content row event-card no-margin">
                    <!-- Lista de franja -->
                    <div class="franja right-align col s12">
                      <!-- Estados de proximidad: 
                        1.- 1 mes de anticipacion: "Próximamente"
                        2.- 2 semanas: "Próxima semana" -->
                      Próximamente &#8226;
                      <!-- Estados de Evento: 
                        1.- Publico
                        2.- Privado -->
                      Evento Publico &#8226;
                      <!-- Gratuito -->
                      Gratuito &#8226;
                      <!-- Numero total de invitados. (nos reservamos los contadores de [Asistentes, Me gusta]) -->
                      300 Invitados &#8226;
                    </div>
                    <!-- Activador-Nombre del Evento -->
                    <span class="card-title activator grey-text text-darken-4">
                      <a href="">{{ object.name }}</a>
                      <i class="material-icons right">more_vert</i>
                    </span>
                    <!-- Fecha del evento -->
                    <div class="col s6 card comentario-izq grey lighten-2">
                      <i class="material-icons medium">today</i>
                      <p class="card-title">Sabado 21 de Mayo, 2017 a las 16H20</p>
                      {% if object.link %}
                        <p><H2> {{object.link}}</H2></p>
                      {% endif %}
                    </div>
                    <!-- Event Place -->
                    <div class="col s6 card comentario-der grey lighten-2">
                      <i class="material-icons medium">location_on</i>
                      <p>En:
                      <div class="chip">
                          <img src="{% static 'showcase/img/event-header.jpg' %}" alt="Contact Person">
                          <a href="">Parque Recreacional</a>
                      </div>
                      <p><a href="">Ver en el mapa</a>
                      </p>
                    </div>
                  </div>
                  <!-- Card content -->
                  <div class="card-reveal">
                    <!-- Info -->
                    <span class="card-title grey-text text-darken-4">Información:<i class="material-icons right">close</i></span>
                    <div class="card-panel gray lighten-3">
                      <p align="justify" class="grey-text text-darken-3 lighten-3">{{ object.description }}</p>
                      <!-- Boton hacia la pagina detalle del evento -->
                      <a href="" class="btn cyan waves-light right"> <i class="material-icons right">visibility</i>Ver m&aacute;s</a>
                    </div>
                    <!-- Date -->
                    <div class="row">
                      <div class="col s2 "><i class="material-icons cyan-text large ">today</i></div><H5 class="col s10">Fecha: Sabado 21 a las 21H00</H5>
                      {% if true %}
                      <div class="col s3 "><i class="material-icons cyan-text large right">shopping_basket</i></div>
                      <h5 class="col s9">Precio: 23,50 </h5> 
                      {% else %}
                      <div class="col s3 right "><i class="material-icons cyan-text large ">stars</i></div>
                      <h5 class="col s9 right-align">Gratuito</h5> 
                      {% endif %}
                      {% if true %}
                      <div class="col s3 "><i class="material-icons cyan-text large ">assignment_ind</i></div>
                      <h5 class="col s9">{{ object.name }}</h5>
                      {%else%}
                      <img class="materialboxed col s3 circle" src="{% static 'showcase/img/alcaldia_morona.png' %}" >
                      <h5 class="col s9">Organizado por: {{ object.name }}</h5>
                      {%endif%}
                    </div>
                    <!-- Chips de Hashtags: Ofertas para el evento -->
                    <div class="col s12 grey lighten-3 comentario-izq">
                      <h3><b class="cyan-text col s1">#</b></h3>
                      <div class"col s11">
                        <div class="chip">
                          <a href="">#RioUpano</a>
                        </div>
                        <div class="chip">
                          <a href="">#Balneario</a>
                        </div>
                        <div class="chip">
                          <img src="{% static 'showcase/img/chumpi.jpg' %}">
                          <a href="">#Chumpi</a>
                        </div>
                        <div class="chip">
                          <a href="">#Comida_italiana</a>
                        </div>
                        
                      </div>
                    </div>

                    <ul class="col s12 collapsible" data-collapsible="accordion">
                      <li>
                        <div class="collapsible-header"><i class="material-icons">perm_data_setting</i>Mas opciones</div>
                        <div class="collapsible-body row no-margin">
                          <a href="#Auspiciar" class="btn col s6 cyan waves-light"> <i class="material-icons right">trending_up</i>Auspiciar</a>
                          <a href="#Denunciar-modal" class="btn col s6 amber-text text-darken-4 red darken-2 waves-light"> <i class="material-icons right">not_interested</i>Denunciar</a>
                        </div>
                      </li>
                    </ul>
                  </div>
                  <!-- Card Actions -->      
                  <div class="card-action row">
                    <a href="" class="btn cyan waves-light col s4 "> <i class="material-icons right">thumb_up</i>Me Gusta</a>
                    <a href="" class="disabled btn cyan waves-light col s4"> <i class="material-icons right">done</i>Asistir </a>
                    <a href="#Invitar" class="disabled btn cyan waves-light col s4"> <i class="material-icons right">supervisor_account</i>Invitar </a>
                  </div> 
                  <!-- Modal Invite -->
                  <div id="Invitar" class="modal">
                    <div class="modal-content">
                      <h4>Invitación</h4>
                      <p>Modal para seleccionar invitados</p>
                    </div>
                    <div class="modal-footer">
                      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Agree</a>
                    </div>
                  </div>
                  <!-- Modal Denunciar -->
                  <div id="Denunciar-modal" class="modal">
                    <div class="modal-content">
                      <h4>Motivo de la denuncia:</h4>
                      <div class="input-field col s12">
                        <select multiple>
                          <optgroup label="team 1">
                            <option value="1">Option 1</option>
                            <option value="2">Option 2</option>
                          </optgroup>
                          <optgroup label="team 2">
                            <option value="3">Option 3</option>
                            <option value="4">Option 4</option>
                          </optgroup>
                        </select>
                        <label>Optgroups</label>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Agree</a>
                    </div>
                  </div>  
                  <!-- Modal Invite -->
                  <div id="Auspiciar" class="modal">
                    <div class="modal-content">
                      <h4>Auspicio</h4>
                      <p>Modal para confirmar auspicio</p>
                    </div>
                    <div class="modal-footer">
                      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Agree</a>
                    </div>
                  </div>  
                </div>
              </div>
            </div> 
          </div><!-- Fin tarjeta evento -->
          </div>
        </div>
        <!-- Comentarios -->
        <div class="section col s12 m8 l8 offset-m2 offset-l2">
          <ul class="collection ">
            <b>Comentarios</b>
            {% for comment in object.comments %}
            <li class="collection-item">
                <div class="chip">                        
                    {% if comment.profile.avatar %}
                    <img src="{{ comment.profile.avatar.url }}" alt="Contact Person">
                    {% else %}
                    <img src="{% static 'showcase/img/event-header.jpg' %}" alt="Contact Person">
                    {% endif %}
                    <a href="/profiles/{{ comment.profile.user.username }}/">{{ comment.profile.user.get_full_name }}</a>
                </div>
                <div class="card-panel comentario-izq">
                    {{ comment.text }}
                    {% if comment.image %}
                    <img src="{{ comment.image.url }}" width="200">
                    {% endif %}
                </div>                
                <p>Hace <strong>{{ comment.date_joined|timesince }}</strong></p>
            </li>
            {% empty %}
            <li class="collection-item">
                No comments yet.
            </li>   
            {% endfor %}
            
            <li class="collection-item">
                <form action="/locality/add/comment/" method="POST" enctype="multipart/form-data" novalidate>
                    {% csrf_token %}
                    <input type="hidden" name="locality" value="{{ object.id }}">
                    <div class="input-field">
                        <input placeholder="Mensaje" id="comment" name="text" type="text" class="validate">
                        <label for="comment">Comenta algo</label>
                    </div>

                    <div class="file-field input-field">
                        <div class="btn">
                            <span>Imagen</span>
                            <input id="image" name="image" type="file">
                        </div>
                        <div class="file-path-wrapper">
                            <input class="file-path validate" type="text">
                        </div>
                    </div>
                    
                    <button type="submit" class="waves-effect waves-light cyan darken-3 btn right marginado">
                        <i class="material-icons right">send</i>
                        Enviar
                    </button>
                </form>     
            </li>
          </ul>
        </div>
    </div>
    {% include 'includes/footer.html'%}
</div>
{% endblock %}

{% block js %}
    <script src="{% static 'plugins/clockpicker/clockpicker.js' %}"></script>
    <script src="{% static 'showcase/js/rango-jquery.js' %}"></script> 
{% endblock %}